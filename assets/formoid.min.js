jQuery(function(e){var t=function(){var t=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push",a=function(){var t=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1];return 8==t||9==t&&"file:"!=location.protocol?function(t,a){var r=new XDomainRequest,n=e.Deferred();return r.open(a.type,t),r.onload=function(){n.resolve(this.responseText)},r.onerror=function(){n.reject()},r.send(a.data),n}:(e.support.cors=!0,e.ajax)}(),r=function(e,t){return e="__"+e+"__",t.length?(this[e]=t[0],this):this[e]},n=function(t,a,r){return e.each(r,function(e,r){t[r]=function(){return a[r].apply(a,arguments)}}),t},o=function(e){e=e||{},this.__email__=e.email||"",this.__title__=e.title||"",this.__data__=e.data||[],this.__recaptcha__=e.recaptcha||""};return o.prototype.email=function(){return r.call(this,"email",arguments)},o.prototype.title=function(){return r.call(this,"title",arguments)},o.prototype.recaptcha_token=function(){return r.call(this,"recaptcha_token",arguments)},o.prototype.data=function(){return r.call(this,"data",arguments)},o.prototype.getCaptchaToken=function(){var t=this.__recaptcha__,a=e.Deferred();return t?grecaptcha.ready(function(){try{grecaptcha.execute(t,{action:"homepage"}).then(function(e){a.resolve(e)})}catch(e){console.error(e),a.resolve(null)}}):a.resolve(null),a.promise()},o.prototype.send=function(r,o){var i=this,s=n(e.Deferred(),this,["email","title","data","send"]),l=this.__recaptcha__?this.getCaptchaToken():e.when();return o&&(o.call(this,s),"pending"!=s.state())?s:(l.then(function(e){e&&(i.__rcph_token__=e)}).always(function(){var e={email:i.__email__,form:{title:i.__title__,data:arguments.length?r:i.__data__}};i.__rcph_token__&&(e.recaptcha_token=i.__rcph_token__),a(t,{type:"POST",data:JSON.stringify(e)}).done(function(e){try{var t=JSON.parse(e);t.error?s.reject(t.error):s.resolve(t.response)}catch(a){s.reject("Incorrect server response.")}}).fail(function(){var e="Failed to query the server. ";e+="onLine"in navigator&&!navigator.onLine?"No connection to the Internet.":"Check the connection and try again.",s.reject(e)})}),s)},{Form:function(e){return new o(e)}}}(),a=function(t){var a=!0,r=e(t).val();return r&&(a=/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(r)),a};e('[data-form-type="formoid"]').each(function(){var r,n=e(this),o=n.is("form")?n:n.find("form"),i=(o.attr("action"),n.find("[data-form-alert]")),s=n.is("[data-form-title]")?n:n.find("[data-form-title]"),l=n.find('[type="submit"]'),c=o.find("[data-form-field]"),d=o.find("[data-form-alert]").length?i.html():i.find("[data-form-alert-success]").html();n.find("[data-form-captcha]");o.change(function(e){"file"===e.target.type&&e.target.files[0].size>1e6&&(i.removeAttr("hidden"),i.removeClass("alert-success").addClass("alert-danger"),i.html("File size must be less than 1mb"),l.addClass("btn-loading").prop("disabled",!0))}),c.each(function(t,a){e(a).on("focus",function(){i.attr("hidden","hidden"),i.addClass("alert-success").removeClass("alert-danger"),i.html(""),l.removeClass("btn-loading").prop("disabled",!1)})}),o.submit(function(f){function h(t){var r=e.Deferred(),n=[];return t.each(function(t,o){var s=e(o),c=s.attr("type"),d=e.Deferred();if(n.push(d),"email"===s.attr("name")&&!a(o))return l.removeClass("btn-loading").prop("disabled",!0),r.reject(new Error("Form is not valid")),!1;switch(c){case"file":var f=new FileReader,h=s.attr("data-form-field")||s.attr("name"),p=s[0].files[0];f.onloadend=function(){u.push([h,f.result]),d.resolve()},f.onerror=function(){i.html(f.error),r.reject(f.error)},p&&f.readAsDataURL(p);break;case"checkbox":u.push([s.attr("data-form-field")||s.attr("name"),s.prop("checked")?s.val():"No"]),d.resolve();break;case"radio":s.prop("checked")&&u.push([s.attr("data-form-field")||s.attr("name"),s.val()]),d.resolve();break;default:u.push([s.attr("data-form-field")||s.attr("name"),s.val()]),d.resolve()}}),r.resolve(n)}if(f.preventDefault(),!l.hasClass("btn-loading")){var u=[],p=c;o.addClass("form-active"),l.addClass("btn-loading").prop("disabled",!0),i.html(""),r=r||t.Form({email:n.find("[data-form-email]").val(),title:s.attr("data-form-title")||s.text(),recaptcha:n.find("[data-form-captcha]").val()||!1}),h(p).then(function(t){e.when.apply(this,t).then(function(){r.send(u).always(function(){l.removeClass("btn-loading").prop("disabled",!1),i.removeAttr("hidden")}).then(function(e){o[0].reset(),o.removeClass("form-active"),i.text(d||e),i.removeClass("alert-danger").addClass("alert-success")}).fail(function(e){i.text(e),i.removeClass("alert-success").addClass("alert-danger")})},function(e){i.html(e.message),i.removeClass("alert-success").addClass("alert-danger"),i.removeAttr("hidden")})})}})})});